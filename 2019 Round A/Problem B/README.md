# B. Parcels

### 描述

给定一个RxC的矩形网格，每一小方格可能是0或1，1代表该位置存在投递部。对于网格里的任意一个方格，其投递距离等于离它最近的投递部的曼哈顿距离度量。现在你可以新增一个投递部，问：最小的全局投递距离是多少？全局投递距离等于各方格投递距离的最大值。

### 分析

首先，我们可以用多源的广度优先搜索算法去计算各个方格的投递距离，时间复杂度为O（RC）。

对于**小数据集**，我们可以遍历新投递部可能放置的所有位置。对于每个可能的位置，再一次遍历所有方格，新投递距离=min(原投递距离,到新投递部的距离），计算全局投递距离。最小的全局投递距离即为输出结果。时间复杂度为O((RC)^2)。

对于**大数据集**，解法非常巧妙。我们将原问题转化为满足性问题，然后使用二分搜索找出最优解。

首先，曼哈顿距离的等价形式如下：

dist((x1, y1), (x2, y2)) = max(abs(x1 + y1 - (x2 + y2)), abs(x1 - y1 - (x2 - y2)))

所以，当固定(x2,y2)时，在x1+y1或者x1-y1取得最大或者最小值时取得最大距离。

利用这一性质，对于一个固定的K值，我们可以通过O(RC)复杂度判断其是否满足：

1.我们预先计算好投递距离大于K的方格的x1+y1和x1-y1的左边界、右边界，这可以在O(RC)复杂度内完成。

2.遍历所有位置以用于放置新投递部，计算每一个可能位置的最大投递距离（根据上面提到的性质，O(1)时间内即可完成）。如果存在一个最大投递距离小于等于K，则当前K值满足要求，否则不符合要求。

3.如果当前K满足要求，记录当前K值，右边界左移。否则，左边界右移。

### 关键字

二维网格，多源广度优先搜索，二分搜索，曼哈顿距离



